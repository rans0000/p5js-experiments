let e;function t(e,t,s,l){Object.defineProperty(e,t,{get:s,set:l,enumerable:!0,configurable:!0})}function s(e){return e&&e.__esModule?e.default:e}var l,n,i=globalThis,r={},a={},o=i.parcelRequirebf15;null==o&&((o=function(e){if(e in r)return r[e].exports;if(e in a){var t=a[e];delete a[e];var s={id:e,exports:{}};return r[e]=s,t.call(s.exports,s,s.exports),s.exports}var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){a[e]=t},i.parcelRequirebf15=o),(0,o.register)("fK5g3",function(e,s){var l,n,i,r;t(e.exports,"defaultEntityConfig",()=>a),t(e.exports,"defaultEdgeConfig",()=>o),t(e.exports,"MOUSE_BTN",()=>l),t(e.exports,"Gamer",()=>n);let a={r:5},o={top:!0,right:!0,bottom:!0,left:!0};(i=l||(l={}))[i.LEFT=0]="LEFT",i[i.MIDDLE=1]="MIDDLE",i[i.RIGHT=2]="RIGHT",(r=n||(n={}))[r.PLAYER=0]="PLAYER",r[r.AI=1]="AI"});var c=o("e93rA"),d=(o("7Pz0b"),o("7Pz0b")),p=o("fK5g3");const h=new(s(d)).Vector(150,150);let w=0;(l=n||(n={}))[l.NORMAL=0]="NORMAL",l[l.ANIMATION=1]="ANIMATION",l[l.DRAG=2]="DRAG",l[l.PAUSED=3]="PAUSED";class u{constructor(e,t){this.p5=e,this.id=t.id,this.board=t.board,this.owner=t.owner,this.cellIndex=t.cellIndex,this.pos=e.createVector(0,0),this.state=0}update(e,t,s){let l=this.board,n=this.board.cells,i=this.p5.createVector(t+100*n[this.cellIndex].pos.x,s+100*n[this.cellIndex].pos.y),r=this.p5.createVector(this.p5.mouseX,this.p5.mouseY);if(0===this.state&&0===l.state&&!this.p5.mouseIsPressed)return this.pos.set(i.x,i.y),this;if(this.owner===p.Gamer.PLAYER&&this.p5.mouseIsPressed&&0===l.state&&0===this.state&&30>i.copy().sub(r).mag())return l.state=this.state=2,this;if(this.owner===p.Gamer.PLAYER&&2===this.state&&this.p5.mouseIsPressed&&this.pos.set(r.x,r.y),this.owner===p.Gamer.PLAYER&&2===this.state&&!this.p5.mouseIsPressed){l.state=this.state=1;let e=l.cells.length;for(let i=0;i<e;i++){if(this.cellIndex===i||n[i].pawn)continue;let e=n[i];if(30>this.p5.createVector(t+100*e.pos.x,s+100*e.pos.y).copy().sub(this.pos).mag()){let{isLegal:e}=this.getLegalMove(l,this.cellIndex,i);if(!e)continue;return this.targetCell=i,this}}return this.targetCell=this.cellIndex,this}if(1===this.state){let e=this.p5.createVector(t+100*n[this.targetCell].pos.x,s+100*n[this.targetCell].pos.y);if(30>e.copy().sub(this.pos).mag()){if(l.state=this.state=0,this.pos.set(e.x,e.y),this.targetCell!==this.cellIndex){let{capturedPawnId:e,isLegal:t}=this.getLegalMove(l,this.cellIndex,this.targetCell);if(!t)return this;let s={pawnId:this.id,targetCellIndex:this.targetCell,capturedPawnId:e,bestScore:0};if(l.movePawn(l,s),l.currentPlayer===p.Gamer.PLAYER){let e=l.checkGameStatus(l);if(void 0!==e)return l.state=this.state=3,l.onResolve&&l.onResolve(e),this;l.currentPlayer=p.Gamer.AI,l.nextMove()}}return this}this.pos.add(e).div(2)}return this}draw(){let{mouseX:e,mouseY:t}=this.p5;this.p5.noStroke(),this.owner===p.Gamer.AI?this.p5.fill(10,80,70):this.p5.fill(200,80,70),this.p5.ellipseMode(this.p5.CENTER),this.p5.circle(this.pos.x,this.pos.y,30),this.owner===p.Gamer.PLAYER&&30>this.p5.createVector(e,t).dist(this.pos)&&this.p5.cursor(this.p5.HAND),this.board.showHelpers&&(this.p5.stroke(255),this.p5.strokeWeight(1),this.p5.noFill(),this.p5.textAlign(this.p5.CENTER,this.p5.CENTER),this.p5.text(`${this.id} (${this.cellIndex})`,this.pos.x,this.pos.y))}getLegalMove(e,t,s){let l,n=!1,i=e.cells[t];for(let t=0;t<i.connectingIndices.length;t++){let r=i.connectingIndices[t];if(r[0]===s&&(n=!0),r[1]===s&&e.cells[r[0]].pawn?.owner!==this.owner&&e.cells[r[0]].pawn?.owner!==void 0){let t=e.pawns.find(e=>e.cellIndex===r[0]);l=t?.id,n=!0}}return{isLegal:n,capturedPawnId:l}}}var I=class{constructor(e,t){var s;let l={showHelpers:!1,currentPlayer:p.Gamer.PLAYER,...t};this.p5=e,this.currentPlayer=l.currentPlayer,this.pawns=[new u(e,{id:0,board:this,owner:p.Gamer.AI,cellIndex:0}),new u(e,{id:1,board:this,owner:p.Gamer.AI,cellIndex:1}),new u(e,{id:2,board:this,owner:p.Gamer.AI,cellIndex:2}),new u(e,{id:3,board:this,owner:p.Gamer.AI,cellIndex:3}),new u(e,{id:4,board:this,owner:p.Gamer.AI,cellIndex:4}),new u(e,{id:5,board:this,owner:p.Gamer.PLAYER,cellIndex:8}),new u(e,{id:6,board:this,owner:p.Gamer.PLAYER,cellIndex:9}),new u(e,{id:7,board:this,owner:p.Gamer.PLAYER,cellIndex:10}),new u(e,{id:8,board:this,owner:p.Gamer.PLAYER,cellIndex:11}),new u(e,{id:9,board:this,owner:p.Gamer.PLAYER,cellIndex:12})],this.cells=(s=this.pawns,[{id:0,pos:e.createVector(0,0),connectingIndices:[[1,2],[3,6],[5,10]],pawn:s[0]},{id:1,pos:e.createVector(2,0),connectingIndices:[[0,void 0],[2,void 0],[3,5],[4,7],[6,11]],pawn:s[1]},{id:2,pos:e.createVector(4,0),connectingIndices:[[1,0],[4,6],[7,12]],pawn:s[2]},{id:3,pos:e.createVector(1,1),connectingIndices:[[0,void 0],[1,void 0],[6,9],[5,void 0]],pawn:s[3]},{id:4,pos:e.createVector(3,1),connectingIndices:[[1,void 0],[2,void 0],[7,void 0],[6,8]],pawn:s[4]},{id:5,pos:e.createVector(0,2),connectingIndices:[[0,void 0],[3,1],[6,7],[8,11],[10,void 0]],pawn:null},{id:6,pos:e.createVector(2,2),connectingIndices:[[3,0],[1,void 0],[4,2],[7,void 0],[9,12],[11,void 0],[8,10],[5,void 0]],pawn:null},{id:7,pos:e.createVector(4,2),connectingIndices:[[4,1],[2,void 0],[12,void 0],[9,11],[6,5]],pawn:null},{id:8,pos:e.createVector(1,3),connectingIndices:[[5,void 0],[6,4],[11,void 0],[10,void 0]],pawn:s[5]},{id:9,pos:e.createVector(3,3),connectingIndices:[[6,3],[7,void 0],[12,void 0],[11,void 0]],pawn:s[6]},{id:10,pos:e.createVector(0,4),connectingIndices:[[5,0],[8,6],[11,12]],pawn:s[7]},{id:11,pos:e.createVector(2,4),connectingIndices:[[8,5],[6,1],[9,7],[12,void 0],[10,void 0]],pawn:s[8]},{id:12,pos:e.createVector(4,4),connectingIndices:[[9,6],[7,2],[11,10]],pawn:s[9]}]),this.state=0,this.showHelpers=l.showHelpers,this.onResolve=l.onResolve}checkGameStatus(e){return 1===e.pawns.length?e.pawns[0].owner:void 0}checkScore(e,t){let s=0;for(let l of e.pawns)s+=l.owner===t?-1:1;return s}nextMove(){w=0;let e=this.currentPlayer,t=e===p.Gamer.AI?p.Gamer.PLAYER:p.Gamer.AI,s=-1/0,l=null,n=-1/0,i=1/0;for(let t of this.pawns)if(t.owner===e)for(let r of this.cells[t.cellIndex].connectingIndices){let a=r[0],o=r[1],c=this.cells[a].pawn;if(void 0!==o&&!this.cells[o].pawn&&c&&c.owner!==e){let r=t.cellIndex;t.cellIndex=o,this.cells[o].pawn=t,this.cells[r].pawn=null;let d=this.pawns.findIndex(e=>e.id===c.id);d>-1&&(this.cells[a].pawn=null,this.pawns.splice(d,1));let p=this.minimax(this,5,!1,e,n,i,`cap// pawn(${t.id}) ${r}-${o}`);this.pawns.splice(d,0,c),this.cells[c.cellIndex].pawn=c,t.cellIndex=r,this.cells[r].pawn=t,this.cells[a].pawn=c,this.cells[o].pawn=null,p>s&&(s=p,l={pawnId:t.id,targetCellIndex:o,capturedPawnId:c.id,bestScore:s})}else if(!c){let r=t.cellIndex;t.cellIndex=a,this.cells[a].pawn=t,this.cells[r].pawn=null;let o=this.minimax(this,5,!1,e,n,i,`mov// pawn(${t.id}) ${r}-${a}`);t.cellIndex=r,this.cells[r].pawn=t,this.cells[a].pawn=null,o>s&&(s=o,l={pawnId:t.id,targetCellIndex:a,bestScore:s})}}l&&(this.movePawn(this,l),this.currentPlayer=t)}minimax(e,t,s,l,n,i,r){++w;let a=this.checkScore(e,l),o=l===p.Gamer.AI?p.Gamer.PLAYER:p.Gamer.AI;if(t<=0)return a;if(s){let s=-1/0;for(let l of e.pawns)if(l.owner===o)for(let r of e.cells[l.cellIndex].connectingIndices){let a=r[0],c=r[1],d=e.cells[a].pawn;if(void 0!==c&&!e.cells[c].pawn&&d&&d.owner!==o){let r=l.cellIndex;l.cellIndex=c,e.cells[c].pawn=l,e.cells[r].pawn=null;let p=e.pawns.findIndex(e=>e.id===d.id);p>-1&&(e.cells[a].pawn=null,e.pawns.splice(p,1));let h=this.minimax(e,t-1,!1,o,n,i,`cap++ pawn(${l.id}) ${r}-${c}`);if(s=Math.max(h,s),e.pawns.splice(p,0,d),e.cells[d.cellIndex].pawn=d,l.cellIndex=r,e.cells[r].pawn=l,e.cells[a].pawn=d,e.cells[c].pawn=null,i<=(n=Math.max(n,h)))break}else if(!d){let r=l.cellIndex;l.cellIndex=a,e.cells[a].pawn=l,e.cells[r].pawn=null;let c=this.minimax(e,t-1,!1,o,n,i,`mov++ pawn(${l.id}) ${r}-${a}`);if(s=Math.max(c,s),l.cellIndex=r,e.cells[r].pawn=l,e.cells[a].pawn=null,i<=(n=Math.max(n,c)))break}}return s}{let s=1/0;for(let l of e.pawns)if(l.owner===o)for(let r of e.cells[l.cellIndex].connectingIndices){let a=r[0],c=r[1],d=e.cells[a].pawn;if(void 0!==c&&!e.cells[c].pawn&&d&&d.owner!==o){let r=l.cellIndex;l.cellIndex=c,e.cells[c].pawn=l,e.cells[r].pawn=null;let p=e.pawns.findIndex(e=>e.id===d.id);p>-1&&(e.cells[a].pawn=null,e.pawns.splice(p,1));let h=this.minimax(e,t-1,!0,o,n,i,`cap-- pawn(${l.id}) ${r}-${c}`);if(s=Math.min(h,s),e.pawns.splice(p,0,d),e.cells[d.cellIndex].pawn=d,l.cellIndex=r,e.cells[r].pawn=l,e.cells[a].pawn=d,e.cells[c].pawn=null,(i=Math.min(i,h))<=n)break}else if(!d){let r=l.cellIndex;l.cellIndex=a,e.cells[a].pawn=l,e.cells[r].pawn=null;let c=this.minimax(e,t-1,!0,o,n,i,`mov-- pawn(${l.id}) ${r}-${a}`);if(s=Math.min(c,s),l.cellIndex=r,e.cells[r].pawn=l,e.cells[a].pawn=null,(i=Math.min(i,c))<=n)break}}return s}}movePawn(e,t){if(!t)return e;let{pawnId:s,targetCellIndex:l,capturedPawnId:n}=t,i=e.pawns.find(e=>e.id===s);if(void 0!==i){let t=i.cellIndex;if(i.cellIndex=l,e.cells[l].pawn=i,e.cells[t].pawn=null,void 0!==n){let t=e.pawns.find(e=>e.id===n);if(!t)return e;let s=e.pawns.findIndex(e=>e.id===t?.id);s>-1&&(e.cells[t.cellIndex].pawn=null,e.pawns.splice(s,1))}}return e}update(e){for(let t=0;t<this.pawns.length;t++){let s=this.pawns[t];this.cells[s.cellIndex],s.update(e,h.x,h.y)}return this}draw(){this.p5.cursor(this.p5.ARROW);for(let e=0;e<this.cells.length;e++){let{x:t,y:s}=this.cells[e].pos,l=h.x+100*t,n=h.y+100*s,i=this.p5.createVector(l,n);if(this.cells[e].connectingIndices.forEach(e=>{let t=e[0],{x:s,y:i}=this.cells[t].pos;this.p5.strokeWeight(2),this.p5.stroke(255,.1),this.p5.line(l,n,h.x+100*s,h.y+100*i)}),this.showHelpers&&(this.p5.stroke(255),this.p5.strokeWeight(1),this.p5.noFill(),this.p5.text(`${this.cells[e].id}  ${null!==this.cells[e].pawn?this.cells[e].pawn?.id:""}`,l+25,n-5)),(0===this.state||2===this.state)&&this.cells[e].pawn?.owner!==p.Gamer.AI){let e=this.p5.createVector(this.p5.mouseX,this.p5.mouseY).sub(i).mag();e<30&&(this.p5.cursor(this.p5.HAND),this.p5.noStroke(),this.p5.fill(255),this.p5.circle(i.x,i.y,this.p5.constrain(30-e,0,15)))}}for(let e of this.pawns)e.draw()}setValues(e,t){if("showHelpers"===e)this.showHelpers=t;else throw"Unsupported key passed to setValues()"}},p=o("fK5g3");new(s(d))(t=>{let s={size:400,showHelpers:!1},l=new c.GUI({autoPlace:!1});l.domElement.id="gui",document.getElementById("gui")?.appendChild(l.domElement),l.add(s,"showHelpers").onChange(t=>{e.setValues("showHelpers",t)}),l.add(s,"size",200,500,10).onChange(e=>{}),t.setup=()=>{t.createCanvas(window.innerWidth,window.innerHeight).parent("app"),t.background("white"),t.pixelDensity(1),t.colorMode(t.HSB),window.addEventListener("resize",()=>(function(e){e.resizeCanvas(window.innerWidth,window.innerHeight)})(t)),t.background(200,60,10),(e=new I(t,{currentPlayer:p.Gamer.PLAYER,showHelpers:s.showHelpers})).currentPlayer===p.Gamer.PLAYER?t.loop():t.noLoop()},t.draw=()=>{t.background(200,60,10),e?.update(t.deltaTime).draw()},t.mouseClicked=e=>{if(e.button!==p.MOUSE_BTN.LEFT)return}});
//# sourceMappingURL=board-game.a34c2aa2.js.map
