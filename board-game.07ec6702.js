let e;function t(e,t,s,n){Object.defineProperty(e,t,{get:s,set:n,enumerable:!0,configurable:!0})}function s(e){return e&&e.__esModule?e.default:e}var n,l,i=globalThis,r={},o={},a=i.parcelRequirebf15;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in o){var t=o[e];delete o[e];var s={id:e,exports:{}};return r[e]=s,t.call(s.exports,s,s.exports),s.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){o[e]=t},i.parcelRequirebf15=a),(0,a.register)("fK5g3",function(e,s){var n,l,i,r;t(e.exports,"defaultEntityConfig",()=>o),t(e.exports,"defaultEdgeConfig",()=>a),t(e.exports,"MOUSE_BTN",()=>n),t(e.exports,"Gamer",()=>l);let o={r:5},a={top:!0,right:!0,bottom:!0,left:!0};(i=n||(n={}))[i.LEFT=0]="LEFT",i[i.MIDDLE=1]="MIDDLE",i[i.RIGHT=2]="RIGHT",(r=l||(l={}))[r.PLAYER=0]="PLAYER",r[r.AI=1]="AI"});var c=a("e93rA"),d=(a("7Pz0b"),a("7Pz0b")),p=a("fK5g3");const h=new(s(d)).Vector(150,150);let w=0;(n=l||(l={}))[n.NORMAL=0]="NORMAL",n[n.ANIMATION=1]="ANIMATION",n[n.DRAG=2]="DRAG",n[n.PAUSED=3]="PAUSED";class u{constructor(e,t){this.p5=e,this.id=t.id,this.board=t.board,this.owner=t.owner,this.cellIndex=t.cellIndex,this.pos=e.createVector(0,0),this.state=0}update(e,t,s){let n=this.board,l=this.board.cells,i=this.p5.createVector(t+100*l[this.cellIndex].pos.x,s+100*l[this.cellIndex].pos.y),r=this.p5.createVector(this.p5.mouseX,this.p5.mouseY);if(0===this.state&&0===n.state&&!this.p5.mouseIsPressed)return this.pos.set(i.x,i.y),this;if(this.owner===p.Gamer.PLAYER&&this.p5.mouseIsPressed&&0===n.state&&0===this.state&&30>i.copy().sub(r).mag())return n.state=this.state=2,this;if(this.owner===p.Gamer.PLAYER&&2===this.state&&this.p5.mouseIsPressed&&this.pos.set(r.x,r.y),this.owner===p.Gamer.PLAYER&&2===this.state&&!this.p5.mouseIsPressed){n.state=this.state=1;let e=n.cells.length;for(let i=0;i<e;i++){if(this.cellIndex===i||l[i].pawn)continue;let e=l[i];if(30>this.p5.createVector(t+100*e.pos.x,s+100*e.pos.y).copy().sub(this.pos).mag()){let{isLegal:e}=this.getLegalMove(n,this.cellIndex,i);if(!e)continue;return this.targetCell=i,this}}return this.targetCell=this.cellIndex,this}if(1===this.state){let e=this.p5.createVector(t+100*l[this.targetCell].pos.x,s+100*l[this.targetCell].pos.y);if(30>e.copy().sub(this.pos).mag()){if(n.state=this.state=0,this.pos.set(e.x,e.y),this.targetCell!==this.cellIndex){let{capturedPawnId:e,isLegal:t}=this.getLegalMove(n,this.cellIndex,this.targetCell);if(!t)return this;let s={pawnId:this.id,targetCellIndex:this.targetCell,capturedPawnId:e,bestScore:0};if(n.movePawn(n,s),n.currentPlayer===p.Gamer.PLAYER){let e=n.checkGameStatus(n);if(void 0!==e)return n.state=this.state=3,n.onResolve&&n.onResolve(e),this;n.currentPlayer=p.Gamer.AI,n.nextMove()}}return this}this.pos.add(e).div(2)}return this}draw(){let{mouseX:e,mouseY:t}=this.p5;this.p5.noStroke(),this.owner===p.Gamer.AI?this.p5.fill(10,80,70):this.p5.fill(200,80,70),this.p5.ellipseMode(this.p5.CENTER),this.p5.circle(this.pos.x,this.pos.y,30),this.owner===p.Gamer.PLAYER&&30>this.p5.createVector(e,t).dist(this.pos)&&this.p5.cursor(this.p5.HAND),this.board.showHelpers&&(this.p5.stroke(255),this.p5.strokeWeight(1),this.p5.noFill(),this.p5.textAlign(this.p5.CENTER,this.p5.CENTER),this.p5.text(`${this.id} (${this.cellIndex})`,this.pos.x,this.pos.y))}getLegalMove(e,t,s){let n,l=!1,i=e.cells[t];for(let t=0;t<i.connectingIndices.length;t++){let r=i.connectingIndices[t];if(r[0]===s&&(l=!0),r[1]===s&&e.cells[r[0]].pawn?.owner!==this.owner&&e.cells[r[0]].pawn?.owner!==void 0){let t=e.pawns.find(e=>e.cellIndex===r[0]);n=t?.id,l=!0}}return{isLegal:l,capturedPawnId:n}}}function I(e,t){return[new u(e,{id:0,board:t,owner:p.Gamer.AI,cellIndex:0}),new u(e,{id:1,board:t,owner:p.Gamer.AI,cellIndex:1}),new u(e,{id:2,board:t,owner:p.Gamer.AI,cellIndex:2}),new u(e,{id:3,board:t,owner:p.Gamer.AI,cellIndex:3}),new u(e,{id:4,board:t,owner:p.Gamer.AI,cellIndex:4}),new u(e,{id:5,board:t,owner:p.Gamer.PLAYER,cellIndex:8}),new u(e,{id:6,board:t,owner:p.Gamer.PLAYER,cellIndex:9}),new u(e,{id:7,board:t,owner:p.Gamer.PLAYER,cellIndex:10}),new u(e,{id:8,board:t,owner:p.Gamer.PLAYER,cellIndex:11}),new u(e,{id:9,board:t,owner:p.Gamer.PLAYER,cellIndex:12})]}function m(e,t){return[{id:0,pos:e.createVector(0,0),connectingIndices:[[1,2],[3,6],[5,10]],pawn:t[0]},{id:1,pos:e.createVector(2,0),connectingIndices:[[0,void 0],[2,void 0],[3,5],[4,7],[6,11]],pawn:t[1]},{id:2,pos:e.createVector(4,0),connectingIndices:[[1,0],[4,6],[7,12]],pawn:t[2]},{id:3,pos:e.createVector(1,1),connectingIndices:[[0,void 0],[1,void 0],[6,9],[5,void 0]],pawn:t[3]},{id:4,pos:e.createVector(3,1),connectingIndices:[[1,void 0],[2,void 0],[7,void 0],[6,8]],pawn:t[4]},{id:5,pos:e.createVector(0,2),connectingIndices:[[0,void 0],[3,1],[6,7],[8,11],[10,void 0]],pawn:null},{id:6,pos:e.createVector(2,2),connectingIndices:[[3,0],[1,void 0],[4,2],[7,void 0],[9,12],[11,void 0],[8,10],[5,void 0]],pawn:null},{id:7,pos:e.createVector(4,2),connectingIndices:[[4,1],[2,void 0],[12,void 0],[9,11],[6,5]],pawn:null},{id:8,pos:e.createVector(1,3),connectingIndices:[[5,void 0],[6,4],[11,void 0],[10,void 0]],pawn:t[5]},{id:9,pos:e.createVector(3,3),connectingIndices:[[6,3],[7,void 0],[12,void 0],[11,void 0]],pawn:t[6]},{id:10,pos:e.createVector(0,4),connectingIndices:[[5,0],[8,6],[11,12]],pawn:t[7]},{id:11,pos:e.createVector(2,4),connectingIndices:[[8,5],[6,1],[9,7],[12,void 0],[10,void 0]],pawn:t[8]},{id:12,pos:e.createVector(4,4),connectingIndices:[[9,6],[7,2],[11,10]],pawn:t[9]}]}var x=class{constructor(e,t){let s={showHelpers:!1,currentPlayer:p.Gamer.PLAYER,...t};this.p5=e,this.currentPlayer=s.currentPlayer,this.pawns=I(e,this),this.cells=m(e,this.pawns),this.state=0,this.showHelpers=s.showHelpers,this.onResolve=s.onResolve}checkGameStatus(e){let t=0,s=0;return e.pawns.forEach(e=>e.owner===p.Gamer.AI?++t:++s),0===t?p.Gamer.PLAYER:0===s?p.Gamer.AI:void 0}checkScore(e,t){let s=0,n=!1;for(let n of e.pawns)s+=n.owner===t?-1:1;return e.pawns.some(e=>e.owner===p.Gamer.AI)?e.pawns.some(e=>e.owner===p.Gamer.PLAYER)||(s*=-1e3,n=!0):(s*=1e3,n=!0),{score:s,hasWon:n}}nextMove(){w=0;let e=this.currentPlayer,t=e===p.Gamer.AI?p.Gamer.PLAYER:p.Gamer.AI,s=-1/0,n=null,l=-1/0,i=1/0;for(let t of(this.p5.noLoop(),this.pawns))if(t.owner===e)for(let r of this.cells[t.cellIndex].connectingIndices){let o=r[0],a=r[1],c=this.cells[o].pawn;if(void 0!==a&&!this.cells[a].pawn&&c&&c.owner!==e){let r=t.cellIndex;t.cellIndex=a,this.cells[a].pawn=t,this.cells[r].pawn=null;let d=this.pawns.findIndex(e=>e.id===c.id);d>-1&&(this.cells[o].pawn=null,this.pawns.splice(d,1));let p=this.minimax(this,5,!1,e,l,i,`cap// pawn(${t.id}) ${r}-${a}`);this.pawns.splice(d,0,c),this.cells[c.cellIndex].pawn=c,t.cellIndex=r,this.cells[r].pawn=t,this.cells[o].pawn=c,this.cells[a].pawn=null,p>s&&(s=p,n={pawnId:t.id,targetCellIndex:a,capturedPawnId:c.id,bestScore:s})}else if(!c){let r=t.cellIndex;t.cellIndex=o,this.cells[o].pawn=t,this.cells[r].pawn=null;let a=this.minimax(this,5,!1,e,l,i,`mov// pawn(${t.id}) ${r}-${o}`);t.cellIndex=r,this.cells[r].pawn=t,this.cells[o].pawn=null,a>s&&(s=a,n={pawnId:t.id,targetCellIndex:o,bestScore:s})}}if(n){this.movePawn(this,n);let e=this.checkGameStatus(this);if(void 0!==e){this.state=this.state=3,this.onResolve&&this.onResolve(e);return}this.currentPlayer=t,this.p5.loop()}}minimax(e,t,s,n,l,i,r){++w;let{score:o,hasWon:a}=this.checkScore(e,n),c=n===p.Gamer.AI?p.Gamer.PLAYER:p.Gamer.AI;if(t<=0||a)return o*(t+1);if(s){let s=-1/0;for(let n of e.pawns)if(n.owner===c)for(let r of e.cells[n.cellIndex].connectingIndices){let o=r[0],a=r[1],d=e.cells[o].pawn;if(void 0!==a&&!e.cells[a].pawn&&d&&d.owner!==c){let r=n.cellIndex;n.cellIndex=a,e.cells[a].pawn=n,e.cells[r].pawn=null;let p=e.pawns.findIndex(e=>e.id===d.id);p>-1&&(e.cells[o].pawn=null,e.pawns.splice(p,1));let h=this.minimax(e,t-1,!1,c,l,i,`cap++ pawn(${n.id}) ${r}-${a}`);if(s=Math.max(h,s),e.pawns.splice(p,0,d),e.cells[d.cellIndex].pawn=d,n.cellIndex=r,e.cells[r].pawn=n,e.cells[o].pawn=d,e.cells[a].pawn=null,i<=(l=Math.max(l,h)))break}else if(!d){let r=n.cellIndex;n.cellIndex=o,e.cells[o].pawn=n,e.cells[r].pawn=null;let a=this.minimax(e,t-1,!1,c,l,i,`mov++ pawn(${n.id}) ${r}-${o}`);if(s=Math.max(a,s),n.cellIndex=r,e.cells[r].pawn=n,e.cells[o].pawn=null,i<=(l=Math.max(l,a)))break}}return s}{let s=1/0;for(let n of e.pawns)if(n.owner===c)for(let r of e.cells[n.cellIndex].connectingIndices){let o=r[0],a=r[1],d=e.cells[o].pawn;if(void 0!==a&&!e.cells[a].pawn&&d&&d.owner!==c){let r=n.cellIndex;n.cellIndex=a,e.cells[a].pawn=n,e.cells[r].pawn=null;let p=e.pawns.findIndex(e=>e.id===d.id);p>-1&&(e.cells[o].pawn=null,e.pawns.splice(p,1));let h=this.minimax(e,t-1,!0,c,l,i,`cap-- pawn(${n.id}) ${r}-${a}`);if(s=Math.min(h,s),e.pawns.splice(p,0,d),e.cells[d.cellIndex].pawn=d,n.cellIndex=r,e.cells[r].pawn=n,e.cells[o].pawn=d,e.cells[a].pawn=null,(i=Math.min(i,h))<=l)break}else if(!d){let r=n.cellIndex;n.cellIndex=o,e.cells[o].pawn=n,e.cells[r].pawn=null;let a=this.minimax(e,t-1,!0,c,l,i,`mov-- pawn(${n.id}) ${r}-${o}`);if(s=Math.min(a,s),n.cellIndex=r,e.cells[r].pawn=n,e.cells[o].pawn=null,(i=Math.min(i,a))<=l)break}}return s}}movePawn(e,t){if(!t)return e;let{pawnId:s,targetCellIndex:n,capturedPawnId:l}=t,i=e.pawns.find(e=>e.id===s);if(void 0!==i){let t=i.cellIndex;if(i.cellIndex=n,e.cells[n].pawn=i,e.cells[t].pawn=null,void 0!==l){let t=e.pawns.find(e=>e.id===l);if(!t)return e;let s=e.pawns.findIndex(e=>e.id===t?.id);s>-1&&(e.cells[t.cellIndex].pawn=null,e.pawns.splice(s,1))}}return e}update(e){for(let t=0;t<this.pawns.length;t++){let s=this.pawns[t];this.cells[s.cellIndex],s.update(e,h.x,h.y)}return this}draw(){this.p5.cursor(this.p5.ARROW);for(let e=0;e<this.cells.length;e++){let{x:t,y:s}=this.cells[e].pos,n=h.x+100*t,l=h.y+100*s,i=this.p5.createVector(n,l);if(this.cells[e].connectingIndices.forEach(e=>{let t=e[0],{x:s,y:i}=this.cells[t].pos;this.p5.strokeWeight(2),this.p5.stroke(255,.1),this.p5.line(n,l,h.x+100*s,h.y+100*i)}),this.showHelpers&&(this.p5.stroke(255),this.p5.strokeWeight(1),this.p5.noFill(),this.p5.text(`${this.cells[e].id}  ${null!==this.cells[e].pawn?this.cells[e].pawn?.id:""}`,n+25,l-5)),(0===this.state||2===this.state)&&this.cells[e].pawn?.owner!==p.Gamer.AI){let e=this.p5.createVector(this.p5.mouseX,this.p5.mouseY).sub(i).mag();e<30&&(this.p5.cursor(this.p5.HAND),this.p5.noStroke(),this.p5.fill(255),this.p5.circle(i.x,i.y,this.p5.constrain(30-e,0,15)))}}for(let e of this.pawns)e.draw()}setValues(e,t){if("showHelpers"===e)this.showHelpers=t;else throw"Unsupported key passed to setValues()"}resetGame(e){let t={showHelpers:!1,currentPlayer:p.Gamer.PLAYER,...e};this.currentPlayer=t.currentPlayer,this.pawns=I(this.p5,this),this.cells=m(this.p5,this.pawns),this.state=0,this.showHelpers=t.showHelpers,this.onResolve=t.onResolve}},p=a("fK5g3");const f=document.getElementById("score-card"),g=document.getElementById("status");new(s(d))(t=>{let s={size:400,showHelpers:!0},n=new c.GUI({autoPlace:!1});function l(e){let t=e===p.Gamer.PLAYER?"You Win!!":"You Loose!!";console.log(t),f&&(f.style.display="flex"),g&&(g.innerText=t)}n.domElement.id="gui",document.getElementById("gui")?.appendChild(n.domElement),n.add(s,"showHelpers").onChange(t=>{e.setValues("showHelpers",t)}),n.add(s,"size",200,500,10).onChange(e=>{}),t.setup=()=>{t.createCanvas(window.innerWidth,window.innerHeight).parent("app"),t.background("white"),t.pixelDensity(1),t.colorMode(t.HSB),window.addEventListener("resize",()=>(function(e){e.resizeCanvas(window.innerWidth,window.innerHeight)})(t)),f&&(f.style.top=`${(window.innerHeight+s.size)/2+30}px`),f?.addEventListener("submit",n=>{n.preventDefault(),f.style.display="none",e.resetGame({currentPlayer:p.Gamer.PLAYER,showHelpers:s.showHelpers,onResolve:l}),t.loop()}),t.background(200,60,10),(e=new x(t,{currentPlayer:p.Gamer.PLAYER,showHelpers:s.showHelpers,onResolve:l})).currentPlayer===p.Gamer.PLAYER?t.loop():t.noLoop()},t.draw=()=>{t.background(200,60,10),e?.update(t.deltaTime).draw()},t.mouseClicked=e=>{if(e.button!==p.MOUSE_BTN.LEFT)return}});
//# sourceMappingURL=board-game.07ec6702.js.map
