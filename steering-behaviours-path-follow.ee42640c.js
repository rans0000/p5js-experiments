let t;function e(t){return t&&t.__esModule?t.default:t}function i(t,e,i,s){Object.defineProperty(t,e,{get:i,set:s,enumerable:!0,configurable:!0})}var s=globalThis,r={},o={},h=s.parcelRequirebf15;null==h&&((h=function(t){if(t in r)return r[t].exports;if(t in o){var e=o[t];delete o[t];var i={id:t,exports:{}};return r[t]=i,e.call(i.exports,i,i.exports),i.exports}var s=Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){o[t]=e},s.parcelRequirebf15=h);var a=h.register;a("hMArn",function(t,s){i(t.exports,"default",()=>a);var r=h("7Pz0b");let o=-1;var a=class{constructor(t,e){let i={pos:t.createVector(0,0),mass:1,velocity:t.createVector(0,0),acceleration:t.createVector(0,0),maxSpeed:15,maxForce:.25,wanderTheta:0,breakingThreshold:100,r:20,material:t.color("#00ffff"),perceptionRadius:30,repelRadius:20,visibilityAngle:Math.PI/3,wrapOnScreenEdge:!1,showHelpers:!1,...e};this.id=++o,this.p5=t,this.pos=i.pos,this.mass=i.mass,this.velocity=i.velocity,this.acceleration=i.acceleration,this.maxSpeed=i.maxSpeed,this.maxForce=i.maxForce,this.wanderTheta=i.wanderTheta,this.breakingThreshold=i.breakingThreshold,this.r=i.r,this.material=i.material,this.perceptionRadius=i.perceptionRadius,this.repelRadius=i.repelRadius,this.visibilityAngle=i.visibilityAngle,this.wrapOnScreenEdge=i.wrapOnScreenEdge,this.showHelpers=i.showHelpers,this.wanderTheta=0}setValues(t,e){if("number"==typeof e)switch(t){case"maxSpeed":this.maxSpeed=e;break;case"maxForce":this.maxForce=e;break;case"perceptionRadius":this.perceptionRadius=e;break;case"repelRadius":this.repelRadius=e;break;case"visibilityAngle":this.visibilityAngle=e;break;default:throw"Unsupported key passed to setValues()"}if("boolean"==typeof e){if("showHelpers"===t)this.showHelpers=e;else throw"Unsupported key passed to setValues()"}}draw(){return this.p5.push(),this.p5.translate(this.pos.x,this.pos.y),this.p5.rotate(this.velocity.heading()),this.showHelpers&&this.drawHelpers(),this.drawSprite(),this.p5.pop(),this}update(){return this.velocity.add(this.acceleration.limit(this.maxForce)),this.velocity.limit(this.maxSpeed),this.pos.add(this.velocity),this.wrapOnScreenEdge&&this.constraintWithinWindow(this.pos.x,this.pos.y),this.acceleration.set(0,0),this}applyForces(t){return t&&this.acceleration.add(t),this}drawSprite(){let t=this.r;return this.p5.stroke(this.material),this.p5.strokeWeight(1),this.p5.noFill(),this.p5.triangle(t,0,-t,t/2,-t,-t/2),this.p5.stroke(50),this}drawHelpers(){this.p5.noStroke(),this.p5.fill(255),this.p5.textSize(15),this.p5.text(this.id,0,0),this.p5.noFill(),this.velocity.mag()<this.maxSpeed?this.p5.stroke(0,80,50):this.p5.stroke(50),this.p5.strokeWeight(1),this.p5.circle(0,0,this.perceptionRadius),this.p5.fill(255,255,255,.3),this.p5.arc(0,0,this.perceptionRadius,this.perceptionRadius,-this.visibilityAngle,this.visibilityAngle);let t=this.p5.createVector(1,0).setMag(this.velocity.mag()).mult(20);return this.p5.line(0,0,t.x,t.y),this}seek(t,i=!1){if(!t)return this.p5.createVector();let s=e(r).Vector.sub(t,this.pos),o=this.maxSpeed;if(i){let t=s.mag();t<this.breakingThreshold&&(o=this.p5.map(t,0,this.breakingThreshold,0,this.maxSpeed))}return s.setMag(o),s.sub(this.velocity),s.limit(this.maxForce),s}flee(t){return null===t?null:this.seek(t).mult(-1)}pursue(t){let e=t.pos.copy(),i=t.velocity.copy();return i.mult(40),e.add(i),this.seek(e)}evade(t){let e=this.pursue(t);return e.mult(-1),e}arrive(t){return this.seek(t,!0)}wander(){let t=this.p5.PI/6,e=50*this.p5.cos(this.wanderTheta),i=50*this.p5.sin(this.wanderTheta),s=this.velocity.copy().setMag(100);return s.add(this.p5.createVector(e,i)),s.add(this.pos),this.constraintWithinWindow(this.pos.x,this.pos.y),this.wanderTheta+=this.p5.random(-t,t),this.seek(s)}pathFollow(t,e=!1){let i=this.velocity.copy().normalize().mult(50).add(this.pos);this.p5.strokeWeight(1),this.p5.stroke(255);let s=t.getClosestSegment(i.x,i.y,e);return s.length&&s.length>t.radius&&s.intersectionPosition?this.seek(s.intersectionPosition):this.velocity.copy()}groupBehaviour(t){let i=this.p5.createVector(),s=this.p5.createVector(),o=this.p5.createVector(),h=t.length;for(let a=0;a<h;a++){if(t[a]===this)continue;let n=this.velocity.copy().normalize().dot(t[a].velocity.copy().normalize()),p=e(r).Vector.dist(t[a].pos,this.pos);if(p>this.perceptionRadius||n>this.visibilityAngle)continue;i.add(t[a].velocity);let l=(this.perceptionRadius-p)/this.perceptionRadius;p>this.repelRadius&&s.add(t[a].pos);let d=this.pos.copy().sub(t[a].pos).div(l);o.add(d),this.p5.stroke(20),this.p5.strokeWeight(2),this.showHelpers&&this.p5.line(t[a].pos.x,t[a].pos.y,this.pos.x,this.pos.y),h-1>0&&(i.div(h-1).sub(this.velocity).setMag(this.maxSpeed),s.div(h-1).sub(this.pos).setMag(this.maxSpeed),o.div(h-1).sub(this.velocity).setMag(this.maxSpeed))}return{alignment:i,cohesion:s,separation:o}}constraintWithinWindow(t,e){let{innerWidth:i,innerHeight:s}=window;t<0&&(this.pos.x=i),t>i&&(this.pos.x=0),e<0&&(this.pos.y=s),e>s&&(this.pos.y=0)}}}),a("7wO5S",function(t,s){i(t.exports,"default",()=>a);var r=h("7Pz0b");let o={radius:2,color:100,isClosed:!1};var a=class{constructor(t,e){let i={...o,...e};this.p5=t,this.mode="view",this.points=[],this.paintRef=this.paint.bind(this),this.radius=i.radius,this.color=i.color,this.isClosed=i.isClosed}setPoints(t){return this.points=t,this.stopPainting()}getPoints(){return this.points}getClosestSegment(t,i,s=!1){let o,h;let a=this.p5.createVector(t,i),n=this.getPoints(),p=n.length;this.p5.angleMode(this.p5.RADIANS),this.p5.colorMode(this.p5.HSB);for(let t=0;t<p;t++){let i=n[t].length,p=0;for(let l=1;!this.isClosed&&l<i||this.isClosed&&l<=i;l++){let d=l%i,c=e(r).Vector.sub(n[t][d],n[t][p]),u=e(r).Vector.sub(a,n[t][p]).dot(c)/c.magSq(),g=c.copy().normalize(),m=s?g.setMag(u*c.mag()):g.setMag(this.p5.constrain(u,0,1)*c.mag());if(s&&(u<0||u>1)){p=d;continue}let w=m.copy().add(n[t][p]),y=w.copy().sub(a).magSq();(void 0===h||y<h)&&(h=y,o=w),p=d}}return{length:h,intersectionPosition:o}}addPoint(t){let e=this.points.length;return this.points[e].push(t.copy()),this}deletePoint(){let t=this.points.length;return this.points[t].pop(),this}startPainting(){return"draw"===this.mode||(this.mode="draw",this.points.push([]),this.p5.canvas.addEventListener("click",this.paintRef)),this}stopPainting(){return"view"===this.mode||(this.mode="view",this.p5.canvas.removeEventListener("click",this.paintRef)),this}togglePainting(){return"view"===this.mode?this.startPainting():this.stopPainting(),this}paint(t){let e=this.p5.createVector(t.x,t.y),i=this.points.length;return this.points[i-1].push(e),this}update(t){return this}draw(){let t=this.points.length;this.p5.stroke(this.color),this.p5.strokeWeight(2*this.radius);for(let e=0;e<t;e++){let i=this.points[e].length;this.p5.noFill(),this.p5.beginShape();for(let t=0;t<i;t++)this.p5.circle(this.points[e][t].x,this.points[e][t].y,10),this.p5.vertex(this.points[e][t].x,this.points[e][t].y);let s=this.isClosed&&"draw"==this.mode&&t>1&&e!==t-1||this.isClosed&&"view"==this.mode;this.p5.endShape(s?"close":void 0),e==t-1&&i>0&&"draw"==this.mode&&this.p5.line(this.points[e][i-1].x,this.points[e][i-1].y,this.p5.mouseX,this.p5.mouseY)}return this}}});var n=h("e93rA"),p=h("7Pz0b"),l=h("hMArn"),d=h("7wO5S");let c=[];new(e(p))(i=>{let s={showHelpers:!1,maxSpeed:3,maxForce:.3},r=new n.GUI({autoPlace:!1});r.domElement.id="gui",document.getElementById("gui")?.appendChild(r.domElement),r.add(s,"showHelpers").onChange(t=>c.forEach(e=>{e.setValues("showHelpers",t)})),r.add(s,"maxSpeed",.1,10,.1).onChange(t=>c.forEach(e=>{e.setValues("maxSpeed",t)})),r.add(s,"maxForce",.01,2,.01).onChange(t=>c.forEach(e=>{e.setValues("maxForce",t)})),i.setup=()=>{i.createCanvas(window.innerWidth,window.innerHeight).parent("app"),i.background("white"),i.pixelDensity(1),i.colorMode(i.HSB),window.addEventListener("resize",()=>(function(t){t.resizeCanvas(window.innerWidth,window.innerHeight)})(i)),function(i){i.background(200,60,10),t=new d.default(i,{isClosed:!0,color:20,radius:20});let r=[[i.createVector(150,300),i.createVector(250,150),i.createVector(550,250),i.createVector(730,150),i.createVector(800,500),i.createVector(400,600)]];t.setPoints(r),c.push(new l.default(i,{pos:i.createVector(i.random(window.innerWidth),i.random(window.innerHeight)),velocity:e(p).Vector.random2D().setMag(s.maxSpeed),maxSpeed:s.maxSpeed,maxForce:s.maxForce,wrapOnScreenEdge:!0}))}(i)},i.draw=()=>{i.background(200,60,10),t.update(i.deltaTime).draw(),function(t,e){for(let i=0;i<e.length;i++){let s=e[i].pathFollow(t,!0);e[i].applyForces(s).update().draw()}}(t,c)}});
//# sourceMappingURL=steering-behaviours-path-follow.ee42640c.js.map
