let e;function t(e,t,s,i){Object.defineProperty(e,t,{get:s,set:i,enumerable:!0,configurable:!0})}var s=globalThis,i={},r={},n=s.parcelRequire326b;null==n&&((n=function(e){if(e in i)return i[e].exports;if(e in r){var t=r[e];delete r[e];var s={id:e,exports:{}};return i[e]=s,t.call(s.exports,s,s.exports),s.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){r[e]=t},s.parcelRequire326b=n),(0,n.register)("fK5g3",function(e,s){var i,r,n,o;t(e.exports,"defaultEntityConfig",()=>l),t(e.exports,"defaultEdgeConfig",()=>h),t(e.exports,"MOUSE_BTN",()=>i),t(e.exports,"Gamer",()=>r);let l={r:5},h={top:!0,right:!0,bottom:!0,left:!0};(n=i||(i={}))[n.LEFT=0]="LEFT",n[n.MIDDLE=1]="MIDDLE",n[n.RIGHT=2]="RIGHT",(o=r||(r={}))[o.PLAYER=0]="PLAYER",o[o.AI=1]="AI"});var o=n("e93rA"),l=n("7Pz0b"),h=n("fK5g3");let a=0;function u(e){let t=[];for(let s=0;s<9;s++)t.push({pos:e.createVector(s%3,Math.floor(s/3)),owner:void 0});return t}function c(e,t,s){return e.owner===t.owner&&e.owner===s.owner}function d(e,t){return t++,void 0===e?0:0===e?-10/t:10/t}var p=class{constructor(e,t){let s={showHelpers:!1,cells:u(e),size:400,status:void 0,currentTurn:h.Gamer.PLAYER,winnerCells:[],...t};if(this.p5=e,this.showHelpers=s.showHelpers,this.cells=s.cells,this.size=s.size,this.status=s.status,this.currentTurn=s.currentTurn,s.winnerCells,this.onResolve=s.onResolve,this.p5.canvas.addEventListener("click",this.onClick.bind(this)),this.currentTurn===h.Gamer.AI){let e=this.calculateBestMove(this.cells);e>-1&&(this.cells[e].owner=h.Gamer.AI),this.currentTurn=h.Gamer.PLAYER}}setValues(e,t){if("number"==typeof t){if("size"===e)this.size=t;else throw"Unsupported key passed to setValues()"}if("boolean"==typeof t){if("showHelpers"===e)this.showHelpers=t;else throw"Unsupported key passed to setValues()"}}onClick(e){if(void 0!==this.status)return;let t=this.size/3,{innerWidth:s,innerHeight:i}=window,r=(s-this.size)/2,n=(i-this.size)/2,{clientX:o,clientY:l}=e;for(let e of this.cells){let s=r+e.pos.x*t,i=n+e.pos.y*t;void 0===e.owner&&o>s&&o<s+this.size/3&&l>i&&l<i+this.size/3&&(e.owner=this.currentTurn,this.currentTurn=this.currentTurn===h.Gamer.AI?h.Gamer.PLAYER:h.Gamer.AI)}if(this.currentTurn===h.Gamer.AI){a=0;let e=this.calculateBestMove(this.cells);e>-1&&(this.cells[e].owner=h.Gamer.AI),this.currentTurn=h.Gamer.PLAYER,console.log(a)}let u=this.checkGameStatus(this.cells);this.status=u.winner,this.winnerCells=u.cells,(0===u.filledCells||void 0!==u.winner)&&this.onResolve&&this.onResolve(u)}calculateBestMove(e=[]){let t=-1/0,s=-1,i=-1/0,r=1/0;for(let n=0;n<9;n++)if(void 0===e[n].owner){e[n].owner=h.Gamer.AI;let o=this.minimax(e,0,!1,i,r,n);this.showHelpers&&console.log("score: ",n,o),e[n].owner=void 0,o>=t&&(t=o,s=n)}return s}minimax(e=[],t,s,i,r,n){let o=this.checkGameStatus(e);if(a++,void 0!==o.winner&&8===o.filledCells&&console.log(o),void 0!==o.winner){let s=d(o.winner,t);return this.showHelpers&&console.log(function(e=[]){let t="";for(let s=0;s<3;s++){for(let i=0;i<3;i++){let r=3*s+i;t+=`${void 0===e[r].owner?"   ":e[r].owner===h.Gamer.AI?" O ":" X "}`}t+="\n"}return t}(e),`C: ${n} P: ${s.toFixed(2)}  D: ${t}`),s}if(void 0===o.winner&&0===o.filledCells)return d(o.winner,t);if(s){let s=-1/0;for(let n=0;n<9;n++)if(void 0===e[n].owner){e[n].owner=h.Gamer.AI;let o=this.minimax(e,t+1,!1,i,r,n);if(e[n].owner=void 0,s=Math.max(o,s),r<=(i=Math.max(i,o)))break}return s}{let s=1/0;for(let n=0;n<9;n++)if(void 0===e[n].owner){e[n].owner=h.Gamer.PLAYER;let o=this.minimax(e,t+1,!0,i,r,n);if(e[n].owner=void 0,s=Math.min(o,s),(r=Math.min(r,o))<=i)break}return s}}checkGameStatus(e){let t,s=0,i=[];for(let t of e)void 0===t.owner&&++s;for(let s=0;s<3;s++){if(void 0!==e[s].owner&&c(e[s],e[s+3],e[s+6])){t=e[s].owner,i=[e[s],e[s+3],e[s+6]];break}if(void 0!==e[3*s].owner&&c(e[3*s],e[1+3*s],e[2+3*s])){t=e[3*s].owner,i=[e[3*s],e[1+3*s],e[2+3*s]];break}}return void 0!==e[0].owner&&c(e[0],e[4],e[8])&&(t=e[0].owner,i=[e[0],e[4],e[8]]),void 0!==e[2].owner&&c(e[2],e[4],e[6])&&(t=e[2].owner,i=[e[2],e[4],e[6]]),{filledCells:s,winner:t,cells:i}}resetGame(e=h.Gamer.PLAYER){if(this.cells=u(this.p5),this.currentTurn=e,this.status=void 0,this.winnerCells=[],this.currentTurn===h.Gamer.AI){let e=this.calculateBestMove(this.cells);e>-1&&(this.cells[e].owner=h.Gamer.AI),this.currentTurn=h.Gamer.PLAYER}}update(e){return this}draw(){this.p5.cursor(this.p5.ARROW);let e=this.size/3,{innerWidth:t,innerHeight:s}=window,i=(t-this.size)/2,r=(s-this.size)/2,{mouseX:n,mouseY:o}=this.p5;for(let t of this.cells){let s=i+t.pos.x*e,l=r+t.pos.y*e;if(this.p5.strokeWeight(1),this.p5.stroke(255),this.p5.fill(40,50,10),this.p5.rectMode(this.p5.CORNER),this.p5.rect(s,l,e,e),this.showHelpers&&(this.p5.textAlign(this.p5.LEFT,this.p5.TOP),this.p5.textSize(15),this.p5.text(t.pos.x+3*t.pos.y,s,l)),void 0!==t.owner){this.p5.strokeWeight(0),this.p5.fill(255),this.p5.textAlign(this.p5.CENTER,this.p5.CENTER),this.p5.textSize(this.size/3);let e=t.owner===h.Gamer.PLAYER?"X":"O";this.p5.text(e,s+this.size/3/2,l+this.size/3/2)}(this.status===h.Gamer.AI||this.status===h.Gamer.PLAYER)&&(this.p5.strokeWeight(10),this.p5.stroke(0,100,100),this.p5.line(i+this.size/3/2+this.winnerCells[0].pos.x*e,r+this.size/3/2+this.winnerCells[0].pos.y*e,i+this.size/3/2+this.winnerCells[2].pos.x*e,r+this.size/3/2+this.winnerCells[2].pos.y*e)),void 0===this.status&&void 0===t.owner&&n>s&&n<s+this.size/3&&o>l&&o<l+this.size/3&&this.p5.cursor(this.p5.HAND)}return this}},h=n("fK5g3");const w=document.getElementById("score-card"),f=document.getElementById("status"),m=document.getElementById("btn-reset");new(l&&l.__esModule?l.default:l)(t=>{let s={showHelpers:!1,size:400,currentTurn:h.Gamer.AI},i=new o.GUI({autoPlace:!1});function r(e){let t="";switch(e.winner){case h.Gamer.PLAYER:t="Player 'X' Wins!!";break;case h.Gamer.AI:t="Player 'O' Wins!!";break;default:t="Game is a Tie!!"}w&&(w.style.display="flex"),f&&(f.innerText=t),m&&(m.style.display="block")}i.domElement.id="gui",document.getElementById("gui")?.appendChild(i.domElement),i.add(s,"showHelpers").onChange(t=>{console.log(t),e.setValues("showHelpers",t)}),i.add(s,"size",200,500,10).onChange(t=>{e.setValues("size",t),w&&(w.style.top=`${(window.innerHeight+t)/2+30}px`)}),t.setup=()=>{t.createCanvas(window.innerWidth,window.innerHeight).parent("app"),t.background("white"),t.pixelDensity(1),t.colorMode(t.HSB),window.addEventListener("resize",()=>(function(e){e.resizeCanvas(window.innerWidth,window.innerHeight)})(t)),w&&(w.style.top=`${(window.innerHeight+s.size)/2+30}px`),w?.addEventListener("submit",t=>{t.preventDefault(),w.style.display="none",s.currentTurn=s.currentTurn===h.Gamer.AI?h.Gamer.PLAYER:h.Gamer.AI,s.currentTurn===h.Gamer.PLAYER&&(w&&(w.style.display="flex"),f&&(f.innerText="Start Game"),m&&(m.style.display="none")),e.resetGame(s.currentTurn)}),function(e){e.background(200,60,10)}(t),e=new p(t,{showHelpers:s.showHelpers,size:s.size,onResolve:r,currentTurn:s.currentTurn})},t.draw=()=>{t.background(200,60,10),e.update(t.deltaTime).draw()}});
//# sourceMappingURL=tic-tac-toe.8b7f2189.js.map
