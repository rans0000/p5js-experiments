let t;function e(t){return t&&t.__esModule?t.default:t}function i(t,e,i,s){Object.defineProperty(t,e,{get:i,set:s,enumerable:!0,configurable:!0})}var s=globalThis,r={},o={},h=s.parcelRequirebf15;null==h&&((h=function(t){if(t in r)return r[t].exports;if(t in o){var e=o[t];delete o[t];var i={id:t,exports:{}};return r[t]=i,e.call(i.exports,i,i.exports),i.exports}var s=Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){o[t]=e},s.parcelRequirebf15=h);var a=h.register;a("hMArn",function(t,s){i(t.exports,"default",()=>a);var r=h("7Pz0b");let o=-1;var a=class{constructor(t,e){let i={pos:t.createVector(0,0),mass:1,velocity:t.createVector(0,0),acceleration:t.createVector(0,0),maxSpeed:15,maxForce:.25,wanderTheta:0,breakingThreshold:100,r:20,material:t.color("#00ffff"),perceptionRadius:10,wrapOnScreenEdge:!1,...e};this.id=++o,this.p5=t,this.pos=i.pos,this.mass=i.mass,this.velocity=i.velocity,this.acceleration=i.acceleration,this.maxSpeed=i.maxSpeed,this.maxForce=i.maxForce,this.wanderTheta=i.wanderTheta,this.breakingThreshold=i.breakingThreshold,this.r=i.r,this.material=i.material,this.perceptionRadius=i.perceptionRadius,this.wrapOnScreenEdge=i.wrapOnScreenEdge,this.wanderTheta=0}setValues(t,e){switch(t){case"maxSpeed":this.maxSpeed=e;break;case"maxForce":this.maxForce=e;break;case"perceptionRadius":this.perceptionRadius=e;break;default:throw"Unsupported key passed to setValues()"}}wrapScreen(){let{innerWidth:t,innerHeight:e}=window;this.pos.x<0?this.pos.x=t:this.pos.x>t&&(this.pos.x=0),this.pos.y<0?this.pos.y=e:this.pos.y>e&&(this.pos.y=0)}draw(t=!1){return this.p5.push(),this.p5.translate(this.pos.x,this.pos.y),t&&this.drawHelpers(),this.p5.rotate(this.velocity.heading()),this.drawSprite(),this.p5.pop(),this}update(){return this.velocity.add(this.acceleration.limit(this.maxForce)),this.velocity.limit(this.maxSpeed),this.pos.add(this.velocity),this.wrapOnScreenEdge&&this.wrapScreen(),this.acceleration.set(0,0),this}applyForces(t){return t&&this.acceleration.add(t),this}drawSprite(){let t=this.r;return this.p5.stroke(this.material),this.p5.strokeWeight(1),this.p5.noFill(),this.p5.triangle(t,0,-t,t/2,-t,-t/2),this.p5.stroke(50),this}drawHelpers(){this.p5.noStroke(),this.p5.fill(255),this.p5.textSize(15),this.p5.text(this.id,0,0),this.p5.noFill(),this.velocity.mag()<this.maxSpeed?this.p5.stroke(0,80,50):this.p5.stroke(50),this.p5.strokeWeight(1),this.p5.circle(0,0,this.perceptionRadius);let t=this.velocity.copy().mult(20);return this.p5.line(0,0,t.x,t.y),this}seek(t,i=!1){if(!t)return this.p5.createVector();let s=e(r).Vector.sub(t,this.pos),o=this.maxSpeed;if(i){let t=s.mag();t<this.breakingThreshold&&(o=this.p5.map(t,0,this.breakingThreshold,0,this.maxSpeed))}return s.setMag(o),s.sub(this.velocity),s.limit(this.maxForce),s}flee(t){return null===t?null:this.seek(t).mult(-1)}pursue(t){let e=t.pos.copy(),i=t.velocity.copy();return i.mult(40),e.add(i),this.seek(e)}evade(t){let e=this.pursue(t);return e.mult(-1),e}arrive(t){return this.seek(t,!0)}wander(){let t=this.p5.PI/6,e=50*this.p5.cos(this.wanderTheta),i=50*this.p5.sin(this.wanderTheta),s=this.velocity.copy().setMag(100);return s.add(this.p5.createVector(e,i)),s.add(this.pos),this.constraintWithinWindow(this.pos.x,this.pos.y),this.wanderTheta+=this.p5.random(-t,t),this.seek(s)}pathFollow(t){let e=this.velocity.copy().normalize().mult(50).add(this.pos);this.p5.strokeWeight(1),this.p5.stroke(255),this.p5.circle(e.x,e.y,5);let i=t.getClosestSegment(e.x,e.y);return i.length&&i.length>t.radius&&i.intersectionPosition?this.seek(i.intersectionPosition):this.velocity.copy()}groupBehaviour(t){let i=this.p5.createVector(),s=this.p5.createVector(),o=this.p5.createVector(),h=t.length;for(let a=0;a<h;a++){if(t[a]===this||e(r).Vector.dist(t[a].pos,this.pos)>this.perceptionRadius)continue;i.add(t[a].velocity),s.add(t[a].pos);let n=this.pos.copy().sub(t[a].pos);o.add(n),this.p5.stroke(20),this.p5.strokeWeight(2),h-1>0&&(i.div(h-1).sub(this.velocity).setMag(this.maxSpeed),s.div(h-1).sub(this.pos).setMag(this.maxSpeed),o.div(h-1).sub(this.velocity).setMag(this.maxSpeed))}return{alignment:i,cohesion:s,separation:o}}constraintWithinWindow(t,e){let{innerWidth:i,innerHeight:s}=window;t<0&&(this.pos.x=i),t>i&&(this.pos.x=0),e<0&&(this.pos.y=s),e>s&&(this.pos.y=0)}}}),a("7wO5S",function(t,s){i(t.exports,"default",()=>a);var r=h("7Pz0b");let o={radius:2,color:100,isClosed:!1};var a=class{constructor(t,e){let i={...o,...e};this.p5=t,this.mode="view",this.points=[],this.paintRef=this.paint.bind(this),this.radius=i.radius,this.color=i.color,this.isClosed=i.isClosed}setPoints(t){return this.points=t,this.stopPainting()}getPoints(){return this.points}getClosestSegment(t,i){let s,o;let h=this.p5.createVector(t,i),a=this.getPoints(),n=a.length;this.p5.angleMode(this.p5.RADIANS),this.p5.colorMode(this.p5.HSB);for(let t=0;t<n;t++){let i=a[t].length,n=0;for(let p=1;!this.isClosed&&p<i||this.isClosed&&p<=i;p++){let d=p%i,l=e(r).Vector.sub(a[t][d],a[t][n]),c=e(r).Vector.sub(h,a[t][n]).dot(l),u=l.copy().normalize().setMag(this.p5.constrain(c/l.magSq(),0,1)*l.mag()).copy().add(a[t][n]),m=u.copy().sub(h).magSq();(void 0===o||m<o)&&(o=m,s=u),n=d}}return{length:o,intersectionPosition:s}}addPoint(t){let e=this.points.length;return this.points[e].push(t.copy()),this}deletePoint(){let t=this.points.length;return this.points[t].pop(),this}startPainting(){return"draw"===this.mode||(this.mode="draw",this.points.push([]),this.p5.canvas.addEventListener("click",this.paintRef)),this}stopPainting(){return"view"===this.mode||(this.mode="view",this.p5.canvas.removeEventListener("click",this.paintRef)),this}togglePainting(){return"view"===this.mode?this.startPainting():this.stopPainting(),this}paint(t){let e=this.p5.createVector(t.x,t.y),i=this.points.length;return this.points[i-1].push(e),this}update(t){return this}draw(){let t=this.points.length;this.p5.stroke(this.color),this.p5.strokeWeight(2*this.radius);for(let e=0;e<t;e++){let i=this.points[e].length;this.p5.noFill(),this.p5.beginShape();for(let t=0;t<i;t++)this.p5.circle(this.points[e][t].x,this.points[e][t].y,10),this.p5.vertex(this.points[e][t].x,this.points[e][t].y);let s=this.isClosed&&"draw"==this.mode&&t>1&&e!==t-1||this.isClosed&&"view"==this.mode;this.p5.endShape(s?"close":void 0),e==t-1&&i>0&&"draw"==this.mode&&this.p5.line(this.points[e][i-1].x,this.points[e][i-1].y,this.p5.mouseX,this.p5.mouseY)}return this}}});var n=h("e93rA"),p=h("7Pz0b"),d=h("hMArn"),l=h("7wO5S");let c=[];new(e(p))(i=>{let s={maxSpeed:1,maxForce:.02,perceptionRadius:70},r=new n.GUI({autoPlace:!1});r.domElement.id="gui",document.getElementById("gui")?.appendChild(r.domElement),r.add(s,"maxSpeed",.1,10,.1).onChange(t=>c.forEach((e,i)=>{0===i&&e.setValues("maxSpeed",t)})),r.add(s,"maxForce",.01,2,.01).onChange(t=>c.forEach((e,i)=>{0===i&&e.setValues("maxForce",t)})),r.add(s,"perceptionRadius",.01,200,10).onChange(t=>c.forEach((e,i)=>{e.setValues("perceptionRadius",t)})),i.setup=()=>{i.createCanvas(window.innerWidth,window.innerHeight).parent("app"),i.background("white"),i.pixelDensity(1),i.colorMode(i.HSB),window.addEventListener("resize",()=>(function(t){t.resizeCanvas(window.innerWidth,window.innerHeight)})(i)),function(i){i.background(200,60,10),t=new l.default(i,{isClosed:!0,color:20,radius:50});let r=[[i.createVector(150,300),i.createVector(250,150),i.createVector(550,250),i.createVector(730,150),i.createVector(850,300),i.createVector(800,500),i.createVector(400,600)]];t.setPoints(r),c=[];for(let t=0;t<10;t++)c.push(new d.default(i,{pos:i.createVector(i.random(window.innerWidth),i.random(window.innerHeight)),velocity:e(p).Vector.random2D().setMag(s.maxSpeed),maxSpeed:s.maxSpeed,maxForce:s.maxForce,perceptionRadius:s.perceptionRadius,wrapOnScreenEdge:!0}))}(i)},i.draw=()=>{i.background(200,60,10),t.update(i.deltaTime).draw(),function(t){let e=[];for(let i=0;i<t.length;i++){let s=t[i].groupBehaviour(t);e.push(s)}for(let i=0;i<t.length;i++)t[i].applyForces(e[i].cohesion.mult(1)).applyForces(e[i].alignment).applyForces(e[i].separation).update().draw(!0)}(c)}});
//# sourceMappingURL=steering-behaviours-path-follow.da1eb787.js.map
